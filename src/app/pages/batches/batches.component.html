@if (loading) {
  <mat-progress-bar mode="indeterminate" class="app-progress-bar"></mat-progress-bar>
}
@if (!loading) {
  <div class="app-fxLayout app-column app-fill">
    <div class="app-fxLayout app-row app-center-v app-breadcrumbsbar">
      <div class="app-fxFlex app-fxLayout app-row app-center-v app-inner app-pr-4">
        <a routerLink="/"><mat-icon>home</mat-icon></a>
        <span class="app-separator">/</span>
        <a routerLink="/import">{{ 'desc.import' | translate }}</a>
        <span class="app-separator">/</span>
        <a routerLink="/process-management">{{ 'desc.batchManagement' | translate }}</a>
        <span class="app-separator">/</span>
        <span class="app-last">{{ 'desc.editing' | translate }}</span>
      </div>
      <div class="app-fxLayout app-row app-center-v app-inner">
        <button mat-button (click)="onIngest()">{{ 'button.continue' | translate }}</button>
        <button mat-icon-button [matTooltip]="'navbar.layout' | translate" (click)="showLayoutAdmin()"><mat-icon>dashboard</mat-icon></button>
      </div>
    </div>
    <div class="app-fxFlex app-fxLayout app-column app-content-wrapper app-batches">
      <div class="app-fxFlex app-border-wrapper">
        @if (settings.importLayout) {
          <as-split direction="horizontal" [disabled]="settings.importLayout.disabled"  (dragEnd)="onDragEnd(-1, $event)">
            @for(column of settings.importLayout.columns; track $index;let icol= $index) {
              @if (column.visible) {
                <as-split-area [size]="column.size">
                  <as-split direction="vertical" [disabled]="settings.importLayout.disabled" (dragEnd)="onDragEnd(icol, $event)">
                    @for(row of column.rows; track $index;let irow= $index) {
                      @if (row.visible) {
                        <as-split-area  [size]="row.size" [class.app-disabled]="!row.canEdit">
                          <app-panel [panel]="row" [lastSelectedItem]="layout.lastSelectedItem()"  (onIngest)="onIngest()" [numOfSelected]="layout.getNumOfSelected()"></app-panel>
                        </as-split-area>
                      }
                    }
                  </as-split>
                </as-split-area>
              }
            }
          </as-split>
        }
      </div>
    </div>
  </div>
}
