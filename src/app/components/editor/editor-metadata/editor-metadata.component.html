<div fxLayout="column" fxFlexFill>
  <div fxLayout="row" class="app-toolbar app-view-description">
		<div fxFlex>
			<app-editor-switcher (onChangeEditorType)="changeEditorType($event)" [editorType]="editorType"></app-editor-switcher>
			<ng-container *ngIf="metadata">
				<button mat-icon-button [matTooltip]="'desc.showOnlyTheElement' | translate" [class.app-active]="byField" (click)="toggleByField()">
					<mat-icon>keyboard_double_arrow_down</mat-icon>
				</button>
				<span class="app-pipe"></span>
				<mat-radio-group aria-label="'standard'" [(ngModel)]="metadata.standard" (change)="setStandard()" class="app-ml-3">
					<mat-radio-button value="rda">rda</mat-radio-button>
					<mat-radio-button value="aacr">aacr</mat-radio-button>
				</mat-radio-group>
			</ng-container>
		</div>
		<div>
			<ng-container *ngIf="!notSaved">
				<button  mat-icon-button (click)="onLoadFromCatalog()" [matTooltip]="'button.metadataCatalog' | translate" [matTooltipPosition]="toolbarTooltipPosition">
					<mat-icon>local_library</mat-icon>
				</button>
				<button mat-icon-button [disabled]="!hasPendingChanges()" (click)="onSave()" [matTooltip]="'button.save' | translate" [matTooltipPosition]="toolbarTooltipPosition">
					<mat-icon>save</mat-icon>
				</button>
			</ng-container>
		</div>
	</div>
	<div fxFlex class="app-oa-">
		<mat-progress-bar mode="indeterminate" *ngIf="state ==='loading'" class="app-progress-bar"></mat-progress-bar>
		<div class="app-editor-content" *ngIf="metadata && state !=='loading'" fxLayout="column">
			<div *ngIf="byField">
				<mat-form-field class="app-w-100 app-p-2 app-mt-1 app-clean-mb">
					<mat-label>{{ 'desc.showOnlyTheElement' | translate }}</mat-label>
					<mat-select [(ngModel)]="selectedField">
						<mat-option *ngFor="let field of availableFields" [value]="field">{{'mods.' + metadata.template[field]['labelKey'] | translate}}</mat-option>
					</mat-select>
				</mat-form-field>
			</div>

			<div [ngSwitch]="model" fxFlex class="app-oa-y">
				<ng-container *ngSwitchCase="'model:chroniclevolume'" [ngTemplateOutlet]="chronicle" ></ng-container>
				<ng-container *ngSwitchCase="'model:chronicletitle'" [ngTemplateOutlet]="chronicle"></ng-container>
				<ng-container *ngSwitchCase="'model:chroniclesupplement'" [ngTemplateOutlet]="chronicle"></ng-container>
				<ng-container *ngSwitchCase="'model:bdmarticle'" [ngTemplateOutlet]="bdm"></ng-container>

				<ng-container *ngSwitchDefault>
					<app-editor-genre *ngIf="showGenreSwitch() && fields['genre']" [field]="metadata.getField('genre')" [showGenreSwitch]="showGenreSwitch()"></app-editor-genre>
					<app-editor-title *ngIf="fields['titleInfo']" [field]="metadata.getField('titleInfo')"></app-editor-title>
					<app-editor-author *ngIf="fields['name']" [field]="metadata.getField('name')" [model]="model"></app-editor-author>
					<app-editor-publisher *ngIf="fields['originInfo']" [field]="metadata.getField('originInfo')"></app-editor-publisher>
					<app-editor-location *ngIf="fields['location']" [field]="metadata.getField('location')"></app-editor-location>
					<app-editor-identifier *ngIf="fields['identifier']" [field]="metadata.getField('identifier')" [model]="model"></app-editor-identifier>
					<app-editor-language *ngIf="fields['language']" [field]="metadata.getField('language')"></app-editor-language>
					<app-editor-physical *ngIf="fields['physicalDescription']" [field]="metadata.getField('physicalDescription')"></app-editor-physical>
					<app-editor-abstract *ngIf="fields['abstract']" [field]="metadata.getField('abstract')"></app-editor-abstract>
					<app-editor-note *ngIf="fields['note']" [field]="metadata.getField('note')"></app-editor-note>
					<app-editor-resource *ngIf="fields['typeOfResource']" [field]="metadata.getField('typeOfResource')"></app-editor-resource>
					<app-editor-genre *ngIf="fields['genre'] && !showGenreSwitch()" [field]="metadata.getField('genre')" ></app-editor-genre>
					<app-editor-classification *ngIf="fields['classification']" [field]="metadata.getField('classification')"></app-editor-classification>
					<app-editor-subject *ngIf="fields['subject']" [field]="metadata.getField('subject')" [model]="model"></app-editor-subject>
					<app-editor-part *ngIf="fields['part']" [field]="metadata.getField('part')"></app-editor-part>
					<app-editor-tableOfContents *ngIf="fields['tableOfContents']" [field]="metadata.getField('tableOfContents')"></app-editor-tableOfContents>
					<app-editor-recordInfo *ngIf="fields['recordInfo']" [field]="metadata.getField('recordInfo')"></app-editor-recordInfo>
					<app-editor-relatedItem *ngIf="fields['relatedItem']" [field]="metadata.getField('relatedItem')" [model]="model"></app-editor-relatedItem>
					<app-editor-genre *ngIf="showGenreSwitch() && (!byField && fields['genre'] || selectedField==='genre')" [field]="metadata.getField('genre')" [showGenreSwitch]="showGenreSwitch()"></app-editor-genre>
					<app-editor-title *ngIf="(!byField && fields['titleInfo'] || selectedField==='titleInfo')" [field]="metadata.getField('titleInfo')"></app-editor-title>
					<app-editor-author *ngIf="(!byField && fields['name'] || selectedField==='name')" [field]="metadata.getField('name')" [model]="model"></app-editor-author>
					<app-editor-publisher *ngIf="(!byField && fields['originInfo'] || selectedField==='originInfo')" [field]="metadata.getField('originInfo')"></app-editor-publisher>
					<app-editor-location *ngIf="(!byField && fields['location'] || selectedField==='location')" [field]="metadata.getField('location')"></app-editor-location>
					<app-editor-identifier *ngIf="(!byField && fields['identifier'] || selectedField==='identifier')" [field]="metadata.getField('identifier')" [model]="model"></app-editor-identifier>
					<app-editor-language *ngIf="(!byField && fields['language'] || selectedField==='language')" [field]="metadata.getField('language')"></app-editor-language>
					<app-editor-physical *ngIf="(!byField && fields['physicalDescription'] || selectedField==='physicalDescription')" [field]="metadata.getField('physicalDescription')"></app-editor-physical>
					<app-editor-abstract *ngIf="(!byField && fields['abstract'] || selectedField==='abstract')" [field]="metadata.getField('abstract')"></app-editor-abstract>
					<app-editor-note *ngIf="(!byField && fields['note'] || selectedField==='note')" [field]="metadata.getField('note')"></app-editor-note>
					<app-editor-resource *ngIf="(!byField && fields['typeOfResource'] || selectedField==='typeOfResource')" [field]="metadata.getField('typeOfResource')"></app-editor-resource>
					<app-editor-genre *ngIf="(!byField && fields['genre'] || selectedField==='genre') && !showGenreSwitch()" [field]="metadata.getField('genre')" ></app-editor-genre>
					<app-editor-classification *ngIf="(!byField && fields['classification'] || selectedField==='classification')" [field]="metadata.getField('classification')"></app-editor-classification>
					<app-editor-subject *ngIf="(!byField && fields['subject'] || selectedField==='subject')" [field]="metadata.getField('subject')" [model]="model"></app-editor-subject>
					<app-editor-part *ngIf="(!byField && fields['part'] || selectedField==='part')" [field]="metadata.getField('part')"></app-editor-part>
					<app-editor-tableOfContents *ngIf="(!byField && fields['tableOfContents'] || selectedField==='tableOfContents')" [field]="metadata.getField('tableOfContents')"></app-editor-tableOfContents>
					<app-editor-recordInfo *ngIf="(!byField && fields['recordInfo'] || selectedField==='recordInfo')" [field]="metadata.getField('recordInfo')"></app-editor-recordInfo>
					<app-editor-relatedItem *ngIf="(!byField && fields['relatedItem'] || selectedField==='relatedItem')" [field]="metadata.getField('relatedItem')" [model]="model"></app-editor-relatedItem>
				</ng-container>
			</div>
		</div>
	</div>
</div>

<ng-template #chronicle>
	<app-editor-chronicle-location *ngIf="(!byField && fields['location'] || selectedField==='location')" [field]="metadata.getField('location')"></app-editor-chronicle-location>
	<app-editor-identifier *ngIf="(!byField && fields['identifier'] || selectedField==='identifier')" [field]="metadata.getField('identifier')"></app-editor-identifier>
	<app-editor-genre *ngIf="(!byField && fields['genre'] || selectedField==='genre')" [field]="metadata.getField('genre')"></app-editor-genre>
	<app-editor-title *ngIf="(!byField && fields['titleInfo'] || selectedField==='titleInfo')" [field]="metadata.getField('titleInfo')"></app-editor-title>
	<app-editor-abstract *ngIf="(!byField && fields['abstract'] || selectedField==='abstract')" [field]="metadata.getField('abstract')"></app-editor-abstract>
	<app-editor-language *ngIf="(!byField && fields['language'] || selectedField==='language')" [field]="metadata.getField('language')"></app-editor-language>
	<app-editor-publisher *ngIf="(!byField && fields['originInfo'] || selectedField==='originInfo')" [field]="metadata.getField('originInfo')"></app-editor-publisher>
	<app-editor-author *ngIf="(!byField && fields['name'] || selectedField==='name')" [field]="metadata.getField('name')" [model]="model"></app-editor-author>
	<app-editor-note *ngIf="(!byField && fields['note'] || selectedField==='note')" [field]="metadata.getField('note')"></app-editor-note>
</ng-template>

<ng-template #bdm>
	<app-editor-genre *ngIf="(!byField && fields['genre'] || selectedField==='genre')" [field]="metadata.getField('genre')" [showGenreSwitch]="true"></app-editor-genre>
	<app-editor-language *ngIf="(!byField && fields['language'] || selectedField==='language')" [field]="metadata.getField('language')"></app-editor-language>
	<app-editor-identifier *ngIf="(!byField && fields['identifier'] || selectedField==='identifier')"
													[field]="metadata.getField('identifier')" [model]="model"></app-editor-identifier>
	<app-editor-physical *ngIf="(!byField && fields['physicalDescription'] || selectedField==='physicalDescription')"
												[field]="metadata.getField('physicalDescription')"></app-editor-physical>
	<app-editor-part *ngIf="(!byField && fields['part'] || selectedField==='part')" [field]="metadata.getField('part')"></app-editor-part>
	<app-editor-title *ngIf="(!byField && fields['titleInfo'] || selectedField==='titleInfo')" [field]="metadata.getField('titleInfo')"></app-editor-title>
	<app-editor-author *ngIf="(!byField && fields['name'] || selectedField==='name')" [field]="metadata.getField('name')" [model]="model"></app-editor-author>
	<app-editor-abstract *ngIf="(!byField && fields['abstract'] || selectedField==='abstract')" [field]="metadata.getField('abstract')"></app-editor-abstract>
	<app-editor-subject *ngIf="(!byField && fields['subject'] || selectedField==='subject')" [field]="metadata.getField('subject')" [model]="model">></app-editor-subject>
	<app-editor-note *ngIf="(!byField && fields['note'] || selectedField==='note')" [field]="metadata.getField('note')"></app-editor-note>
	<app-editor-classification *ngIf="(!byField && fields['classification'] || selectedField==='classification')" [field]="metadata.getField('classification')"></app-editor-classification>
	<app-editor-location *ngIf="(!byField && fields['location'] || selectedField==='location')" [field]="metadata.getField('location')"></app-editor-location>
	<app-editor-relatedItem *ngIf="(!byField && fields['relatedItem'] || selectedField==='relatedItem')" [field]="metadata.getField('relatedItem')" [model]="model"></app-editor-relatedItem>
	<app-editor-recordInfo *ngIf="(!byField && fields['recordInfo'] || selectedField==='recordInfo')" [field]="metadata.getField('recordInfo')"></app-editor-recordInfo>
</ng-template>
