<div fxLayout="column" fxFlexFill>
  <div fxLayout="row" fxLayoutAlign="start center" class="app-toolbar app-view-metadata" *ngIf="switchable">
    <div fxFlex *ngIf="layout.getNumOfSelected() > 1">
      <div class="app-toolbar-label">
        <span class="app-text">{{ 'editor.children.multiple_selection_label' | translate }}</span>
        <span class="app-pipe"></span>
        <span class="app-text-supplement">{{ ('editor.children.multiple_selection_count' + countPlurals() ) | translate: { count: layout.getNumOfSelected() } }}</span>
      </div>
    </div>
    <div fxFlex *ngIf="!layout.showPagesEditor()">
      <button mat-icon-button [matTooltip]="'editor.toolbar.editor_metadata' | translate" [matTooltipPosition]="toolbarTooltipPosition" [class.app-active]="editorType === 'metadata'" (click)="editorType = 'metadata'">
        <span class="app-text-icon">M</span>
      </button>
      <!-- to delete after testing <button mat-icon-button *ngIf="layout.lastSelectedItem && layout.lastSelectedItem.isPage()" [matTooltip]="'editor.toolbar.editor_image' | translate" [matTooltipPosition]="toolbarTooltipPosition" [class.app-active]="editorType === 'image'" (click)="editorType = 'image'">
        <mat-icon>image</mat-icon>
      </button> -->
      <button mat-icon-button *ngIf="layout.lastSelectedItem && layout.lastSelectedItem.isAudioPage()" [matTooltip]="'editor.toolbar.editor_song' | translate" [matTooltipPosition]="toolbarTooltipPosition" [class.app-active]="editorType === 'song'" (click)="editorType = 'song'">
        <mat-icon>audiotrack</mat-icon>
      </button>
      <!-- <button mat-icon-button *ngIf="layout.lastSelectedItem && layout.lastSelectedItem.canContainPdf()" [matTooltip]="'editor.toolbar.editor_pdf' | translate" [matTooltipPosition]="toolbarTooltipPosition" [class.app-active]="editorType === 'pdf'" (click)="editorType = 'pdf'">
        <mat-icon>picture_as_pdf</mat-icon>
      </button> -->
      <button mat-icon-button [matTooltip]="'editor.toolbar.editor_mods' | translate" [matTooltipPosition]="toolbarTooltipPosition" [class.app-active]="editorType === 'mods'" (click)="editorType = 'mods'">
        <mat-icon>code</mat-icon>
      </button>
      <button mat-icon-button *ngIf="layout.lastSelectedItem && layout.lastSelectedItem.isPage()" [matTooltip]="'editor.toolbar.editor_ocr' | translate" [matTooltipPosition]="toolbarTooltipPosition" [class.app-active]="editorType === 'ocr'" (click)="editorType = 'ocr'">
        <mat-icon>title</mat-icon>
      </button>
      <button mat-icon-button [matTooltip]="'editor.toolbar.editor_atm' | translate" [matTooltipPosition]="toolbarTooltipPosition" [class.app-active]="editorType === 'atm'" (click)="editorType = 'atm'">
        <span class="app-text-icon">A</span>
      </button>
      <!-- to delete after testing <button mat-icon-button *ngIf="config.showCommentEditor" [matTooltip]="'editor.toolbar.editor_comment' | translate" [matTooltipPosition]="toolbarTooltipPosition" [class.app-active]="editorType === 'comment'" (click)="editorType = 'comment'">
        <mat-icon>format_quote</mat-icon>
      </button> -->
    </div>
		<div>
      <button mat-icon-button (click)="onRevert()" [matTooltip]="'common.revert' | translate" [matTooltipPosition]="toolbarTooltipPosition" [disabled]="!atm || !atm.hasChanged()">
        <mat-icon>replay</mat-icon>
      </button>
      <button mat-icon-button (click)="onSave()" [matTooltip]="'common.save' | translate" [matTooltipPosition]="toolbarTooltipPosition" [disabled]="!atm || !atm.hasChanged()">
        <mat-icon>save</mat-icon>
      </button>
		</div>
  </div>
	<div fxFlex class="app-oa-y">
		<mat-progress-bar mode="indeterminate" *ngIf="state ==='loading'" class="app-progress-bar"></mat-progress-bar>
		<div class="app-editor-content app-atm-editor-content" *ngIf="state !== 'loading' && atm">
      <div class="app-detail-key-value">{{ 'editor.atm.pid' | translate }}: <strong>{{ atm.pid }}</strong></div>
      <div class="app-detail-key-value">{{ 'editor.atm.model' | translate }}: <strong>{{ "model." + atm.model | translate }}</strong></div>
      <div class="app-detail-key-value">{{ 'editor.atm.owner' | translate }}: <strong>{{ atm.owner }}</strong></div>
      <div class="app-detail-key-value">{{ 'editor.atm.created' | translate }}: <strong>{{ atm.created | appDatetime }}</strong></div>
      <div class="app-detail-key-value">{{ 'editor.atm.modified' | translate }}: <strong>{{ atm.modified | appDatetime }}</strong></div>
      <div class="app-detail-key-value">{{ 'editor.atm.filename' | translate }}: <strong>{{ atm.filename || '-' }}</strong></div>
      <div class="app-detail-key-value">{{ 'editor.atm.export' | translate }}: <strong>{{ atm.exportResult || '-' }}</strong></div>
      <div>
        <mat-form-field>
          <mat-select [placeholder]="'editor.atm.device' | translate" name="device" [(value)]="atm.device">
            <mat-option [value]="'null'">{{ 'editor.atm.no_device' | translate }}</mat-option>
            <mat-option *ngFor="let device of devices" [value]="device.id">{{ device.label }}</mat-option>
          </mat-select>
        </mat-form-field>
      </div>
      <div>
        <mat-form-field>
          <mat-select [disabled]="!auth.isSuperAdmin()" [placeholder]="'editor.atm.organization' | translate" name="organization" [(value)]="atm.organization">
            <mat-option *ngFor="let organization of organizations" [value]="organization">{{ 'organization.' + organization | translate }}</mat-option>
          </mat-select>
        </mat-form-field>
      </div>
      <div>
        <mat-form-field>
          <mat-select [disabled]="!auth.isSuperAdmin() && !auth.isAdmin()" [placeholder]="'editor.atm.userProcessor' | translate" name="userProcessor" [(value)]="atm.userProcessor">
            <mat-option *ngFor="let user of users" [value]="user.name">{{ user.name }}</mat-option>
            <mat-option value="all">VÅ¡ichni</mat-option>
          </mat-select>
        </mat-form-field>
      </div>
      <div>
        <mat-form-field>
          <mat-select [placeholder]="'editor.atm.status' | translate" name="status" [(value)]="atm.status">
            <mat-option *ngFor="let status of statuses" [value]="status">{{ 'editor.atm.statuses.' + status | translate }}</mat-option>
          </mat-select>
        </mat-form-field>
      </div>
      <div *ngIf="atm.isLocked">
        <div class="app-detail-key-value"><strong>{{ 'search.isLocked' | translate }}</strong></div>
        <div class="app-detail-key-value">{{ 'editor.atm.lockedBy' | translate }}: <strong>{{ atm.lockedBy }}</strong></div>
        <div class="app-detail-key-value">{{ 'editor.atm.lockedDate' | translate }}: <strong>{{ atm.lockedDate | date : 'dd.MM.yyyy' }}</strong></div>
      </div>
      <div>
        <mat-form-field>
          <mat-select [placeholder]="'editor.atm.donator' | translate" name="donator" [(value)]="atm.donator">
            <mat-option [value]="null">{{ 'editor.atm.donators.none' | translate }}</mat-option>
            <mat-option *ngFor="let donator of donators" [value]="donator">{{ 'editor.atm.donators.' + donator | translate }}</mat-option>
          </mat-select>
        </mat-form-field>
      </div>
    </div>
	</div>
</div>